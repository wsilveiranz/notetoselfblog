<!DOCTYPE html>
<html lang="en">
<head>

    <title>Managing personal office communication with MS Flow</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="preload" as="style" href="/notetoselfblog/assets/built/screen.css?v=c95e7abf59">
    <link rel="preload" as="script" href="/notetoselfblog/assets/built/source.js?v=c95e7abf59">

    <link rel="stylesheet" type="text/css" href="/notetoselfblog/assets/built/screen.css?v=c95e7abf59">

    <style>
        :root {
            --background-color: #ffffff
        }
    </style>

    <script>
        /* The script for calculating the color contrast has been taken from
        https://gomakethings.com/dynamically-changing-the-text-color-based-on-background-color-contrast-with-vanilla-js/ */
        var accentColor = getComputedStyle(document.documentElement).getPropertyValue('--background-color');
        accentColor = accentColor.trim().slice(1);
        var r = parseInt(accentColor.substr(0, 2), 16);
        var g = parseInt(accentColor.substr(2, 2), 16);
        var b = parseInt(accentColor.substr(4, 2), 16);
        var yiq = ((r * 299) + (g * 587) + (b * 114)) / 1000;
        var textColor = (yiq >= 128) ? 'dark' : 'light';

        document.documentElement.className = `has-${textColor}-text`;
    </script>

    <link rel="canonical" href="http://localhost:2368/managing-personal-office-communication-with-ms-flow/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="Note to Self - Ghost Edition">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Managing personal office communication with MS Flow">
    <meta property="og:description" content="It’s 10:00 am of a Wednesday and I am in my childhood home, having a chat with my dad and spending some time relaxing. As it is raining today, beach is not an option, and cinema is scheduled for later today.





So what better to pass the time">
    <meta property="og:url" content="http://localhost:2368/managing-personal-office-communication-with-ms-flow/">
    <meta property="og:image" content="http://localhost:2368/notetoselfblog/content/images/wordpress/2017/08/pexels-photo-355988-e1523124973460.jpeg">
    <meta property="article:published_time" content="2019-07-15T13:54:57.000Z">
    <meta property="article:modified_time" content="2019-07-15T13:55:05.000Z">
    <meta property="article:tag" content="Microsoft Flow">
    <meta property="article:tag" content="Microsoft Teams">
    <meta property="article:tag" content="Office 365">
    
    <meta property="article:publisher" content="https://www.facebook.com/ghost">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Managing personal office communication with MS Flow">
    <meta name="twitter:description" content="It’s 10:00 am of a Wednesday and I am in my childhood home, having a chat with my dad and spending some time relaxing. As it is raining today, beach is not an option, and cinema is scheduled for later today.





So what better to pass the time">
    <meta name="twitter:url" content="http://localhost:2368/managing-personal-office-communication-with-ms-flow/">
    <meta name="twitter:image" content="http://localhost:2368/notetoselfblog/content/images/wordpress/2017/08/pexels-photo-355988-e1523124973460.jpeg">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="wsilveiranz">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Microsoft Flow, Microsoft Teams, Office 365">
    <meta name="twitter:site" content="@ghost">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="507">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Note to Self - Ghost Edition",
        "url": "http://localhost:2368/",
        "logo": {
            "@type": "ImageObject",
            "url": "http://localhost:2368/favicon.ico"
        }
    },
    "author": {
        "@type": "Person",
        "name": "wsilveiranz",
        "image": {
            "@type": "ImageObject",
            "url": "https://secure.gravatar.com/avatar/8cf8f21650fd5355a5b2c08e0f9ca914?s=512&d=mm&r=g",
            "width": 512,
            "height": 512
        },
        "url": "http://localhost:2368/author/wsilveiranz/",
        "sameAs": []
    },
    "headline": "Managing personal office communication with MS Flow",
    "url": "http://localhost:2368/managing-personal-office-communication-with-ms-flow/",
    "datePublished": "2019-07-15T13:54:57.000Z",
    "dateModified": "2019-07-15T13:55:05.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "http://localhost:2368/notetoselfblog/content/images/wordpress/2017/08/pexels-photo-355988-e1523124973460.jpeg",
        "width": 1200,
        "height": 507
    },
    "keywords": "Microsoft Flow, Microsoft Teams, Office 365",
    "description": "\n\n\nIt’s 10:00 am of a Wednesday and I am in my childhood home, having a chat with my dad and spending some time relaxing. As it is raining today, beach is not an option, and cinema is scheduled for later today.\n\n\n\n\n\nSo what better to pass the time until later than write a light post? So, instead of focusing on AIS or some “enterprise like” technology, I decided to talk about something I made to make my life simpler, using Microsoft Flow, Teams and Outlook – my ultimate out of office communicatio",
    "mainEntityOfPage": "http://localhost:2368/managing-personal-office-communication-with-ms-flow/"
}
    </script>

    <meta name="generator" content="Ghost 5.75">
    <link rel="alternate" type="application/rss+xml" title="Note to Self - Ghost Edition" href="http://localhost:2368/rss/">
    <script defer src="https://cdn.jsdelivr.net/ghost/portal@~2.36/umd/portal.min.js" data-i18n="false" data-ghost="http://localhost:2368/" data-key="4d946a7b27dfe0cf2428731cab" data-api="http://localhost:2368/ghost/api/notetoselfblog/content/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="4d946a7b27dfe0cf2428731cab" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/main.css" data-sodo-search="http://localhost:2368/" crossorigin="anonymous"></script>
    
    <link href="http://localhost:2368/webmentions/receive/" rel="webmention">
    <script defer src="/public/member-attribution.min.js?v=c95e7abf59"></script><style>:root {--ghost-accent-color: #FF1A75;}</style>

</head>
<body class="post-template tag-microsoft-flow tag-microsoft-teams tag-office-365 tag-hash-wordpress tag-hash-import-2023-12-17-09-11 has-sans-title has-sans-body">

<div class="gh-viewport">
    
    <header id="gh-navigation" class="gh-navigation is-middle-logo gh-outer">
    <div class="gh-navigation-inner gh-inner">

        <div class="gh-navigation-brand">
            <a class="gh-navigation-logo is-title" href="http://localhost:2368">
                    Note to Self - Ghost Edition
            </a>
            <button class="gh-search gh-icon-button" aria-label="Search this site" data-ghost-search>
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>            <button class="gh-burger gh-icon-button">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256"><path d="M224,128a8,8,0,0,1-8,8H40a8,8,0,0,1,0-16H216A8,8,0,0,1,224,128ZM40,72H216a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16ZM216,184H40a8,8,0,0,0,0,16H216a8,8,0,0,0,0-16Z"></path></svg>                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256"><path d="M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z"></path></svg>            </button>
        </div>

        <nav class="gh-navigation-menu">
            <ul class="nav">
    <li class="nav-home"><a href="http://localhost:2368/">Home</a></li>
    <li class="nav-about"><a href="http://localhost:2368/about/">About</a></li>
</ul>

        </nav>

        <div class="gh-navigation-actions">
                <button class="gh-search gh-icon-button" aria-label="Search this site" data-ghost-search>
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>                <div class="gh-navigation-members">
                            <a href="#/portal/signin" data-portal="signin">Sign in</a>
                                <a class="gh-button" href="#/portal/signup" data-portal="signup">Subscribe</a>
                </div>
        </div>

    </div>
</header>

    

<main class="gh-main">

    <article class="gh-article post tag-microsoft-flow tag-microsoft-teams tag-office-365 tag-hash-wordpress tag-hash-import-2023-12-17-09-11">

        <header class="gh-article-header gh-canvas">

                <a class="gh-article-tag" href="http://localhost:2368/tag/microsoft-flow/">Microsoft Flow</a>
            <h1 class="gh-article-title is-title">Managing personal office communication with MS Flow</h1>

            <div class="gh-article-meta">
                <div class="gh-article-author-image">
                            <a href="/notetoselfblog/author/wsilveiranz/">
                                <img class="author-profile-image" src="https://secure.gravatar.com/avatar/8cf8f21650fd5355a5b2c08e0f9ca914?s&#x3D;512&amp;d&#x3D;mm&amp;r&#x3D;g" alt="wsilveiranz" />
                            </a>
                </div>
                <div class="gh-article-meta-wrapper">
                    <h4 class="gh-article-author-name"><a href="/notetoselfblog/author/wsilveiranz/">wsilveiranz</a></h4>
                    <div class="gh-article-meta-content">
                        <time class="gh-article-meta-date" datetime="2019-07-15">Jul 15, 2019</time>
                            <span class="gh-article-meta-length"><span class="bull">—</span> 7 min read</span>
                    </div>
                </div>
            </div>

                <figure class="gh-article-image">
        <img
            srcset="/notetoselfblog/content/images/size/w320/wordpress/2017/08/pexels-photo-355988-e1523124973460.jpeg 320w,
                    /notetoselfblog/content/images/size/w600/wordpress/2017/08/pexels-photo-355988-e1523124973460.jpeg 600w,
                    /notetoselfblog/content/images/size/w960/wordpress/2017/08/pexels-photo-355988-e1523124973460.jpeg 960w,
                    /notetoselfblog/content/images/size/w1200/wordpress/2017/08/pexels-photo-355988-e1523124973460.jpeg 1200w,
                    /notetoselfblog/content/images/size/w2000/wordpress/2017/08/pexels-photo-355988-e1523124973460.jpeg 2000w"
            src="/notetoselfblog/content/images/size/w1200/wordpress/2017/08/pexels-photo-355988-e1523124973460.jpeg"
            alt="Managing personal office communication with MS Flow"
        >
    </figure>

        </header>

        <section class="gh-content gh-canvas is-body">
            <!--kg-card-begin: html-->
<p>It&#8217;s 10:00 am of a Wednesday and I am in my childhood home, having a chat with my dad and spending some time relaxing. As it is raining today, beach is not an option, and cinema is scheduled for later today. </p>



<p>So what better to pass the time until later than write a light post? So, instead of focusing on AIS or some &#8220;enterprise like&#8221; technology, I decided to talk about something I made to make my life simpler, using Microsoft Flow, Teams and Outlook &#8211; my ultimate out of office communication.</p>



<h2>The requirements</h2>



<p>For a bit of background, at Theta we had a long time tradition to indicate people whereabouts on email using a tag like OUT (out in a client), WFH (working from home), etc. That came from the time where the team was quite small and email was the main method of communication. With the team growing, earlier this year we made a request for people to move that kind of notification to Teams, on Theta&#8217;s General channel. But then I thought &#8211; why do I have to connect to teams to do that every time? There should be a better way&#8230;</p>



<p>In the end, the better way for me was a Flow button that allowed me to decide exactly what I wanted to do &#8211; I designed the flow to do the following:</p>



<ul><li>Choose the type of notification I wanted to send:<ul><li>Out of Office (OUT)</li><li>Working from Home (WFH)</li><li>Sick Leave (SICK)</li><li>Late to Work (LATE)</li></ul></li><li>Have an optional text explaining the reason for the notification</li><li>Send an email to my manager indicating my whereabouts.<ul><li>Optionally, send a copy of the email I send to my manager to a list of people I chose.</li></ul></li><li>Optionally, turn on automatic replies and adjust the text and the duration of the automatic replies.</li></ul>



<!--more-->



<h2>Flow Design</h2>



<figure class="wp-block-image is-resized"><img loading="lazy" src="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/flow-ooo-design-1024x280.png" alt class="wp-image-2852" width="620" height="170" srcset="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/flow-ooo-design-1024x280.png 1024w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/flow-ooo-design-300x82.png 300w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/flow-ooo-design-768x210.png 768w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/flow-ooo-design-1200x328.png 1200w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/flow-ooo-design.png 1680w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 984px) 61vw, (max-width: 1362px) 45vw, 600px"></figure>



<p>The flow is based on a manual input trigger Flow button (1) and perform the following actions:</p>



<ul><li>Identify the Office 365 profile of the user running the flow (2)</li><li>Identify the Manager associated to that Office 365 profile (3)</li><li>Define the template of the message for MS Teams (4)</li><li>Define the template of the email to the manager (5)</li><li>Define is Automatic replies are required and define its template (6)</li></ul>



<div class="wp-block-media-text alignwide" style="grid-template-columns:14% auto"><figure class="wp-block-media-text__media"><img loading="lazy" width="240" height="240" src="http://localhost:2368/notetoselfblog/content/images/wordpress/2017/09/notetoself_logo-3.png" alt class="wp-image-1214" srcset="http://localhost:2368/notetoselfblog/content/images/wordpress/2017/09/notetoself_logo-3.png 240w, http://localhost:2368/notetoselfblog/content/images/wordpress/2017/09/notetoself_logo-3-150x150.png 150w" sizes="(max-width: 240px) 85vw, 240px"></figure><div class="wp-block-media-text__content">
<p>If y<em>ou want to try this Flow yourself, you can get a copy </em><a rel="noreferrer noopener" aria-label="here (opens in a new tab)" href="https://github.com/wsilveiranz/MSFlowsamples/blob/master/OutofOfficeCommunications.zip?ref=localhost" target="_blank"><em>here</em></a><em>. Just import it and tweak it for your own requirements.</em></p>
</div></div>



<h3>Flow Button input details</h3>



<p>My Flow button is defined with the following inputs:</p>



<figure class="wp-block-image is-resized"><img loading="lazy" src="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/flow-button-trigger..png" alt class="wp-image-2846" width="593" height="692" srcset="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/flow-button-trigger..png 790w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/flow-button-trigger.-257x300.png 257w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/flow-button-trigger.-768x897.png 768w" sizes="(max-width: 593px) 85vw, 593px"></figure>



<ul><li>Notification type (required) &#8211; a dropdown with the values of notification types, based on the classic acronyms used to prefix the classic email comms at Theta .</li><li>Notification detail (required) &#8211; a free text for additional information or reason for the notification.</li><li>Return Date (optional) &#8211; a date field indicating when I am expecting to come back to work.</li><li>Create Out of Office (optional) &#8211; a boolean field indicating if I want to setup automatic replies (Out of Office) notification in Outlook.</li><li>Additional Notification People (optional) &#8211; a list of emails for people that I want to cc when sending a an email notification to my manager.</li></ul>



<div class="wp-block-media-text alignwide" style="grid-template-columns:18% auto"><figure class="wp-block-media-text__media"><img loading="lazy" width="240" height="240" src="http://localhost:2368/notetoselfblog/content/images/wordpress/2017/09/notetoself_logo-3.png" alt class="wp-image-1214" srcset="http://localhost:2368/notetoselfblog/content/images/wordpress/2017/09/notetoself_logo-3.png 240w, http://localhost:2368/notetoselfblog/content/images/wordpress/2017/09/notetoself_logo-3-150x150.png 150w" sizes="(max-width: 240px) 85vw, 240px"></figure><div class="wp-block-media-text__content">
<p><em>It is interesting to notice how rich the user experience can be when using the flow button. From required x optional field, to a set of different types of input controls, the flow maker have full control of what they are expecting to provide to the end user. That is another feature that differentiates MS Flow from Logic Apps.</em></p>
</div></div>



<h3>User Input and Manager Definition</h3>



<div class="wp-block-image"><figure class="alignleft is-resized"><img loading="lazy" src="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/User-profile.png" alt class="wp-image-2853" width="225" height="110" srcset="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/User-profile.png 945w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/User-profile-300x147.png 300w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/User-profile-768x377.png 768w" sizes="(max-width: 225px) 85vw, 225px"></figure></div>



<p>The actions to define the user and the managers are both provided by Office 365 and are called <strong>Get My Profile</strong> and <strong>Find My Manager</strong>, respectively. While Get My Profile doesn&#8217;t require any additional input, Find My Manager requires the User Principal Name (UPN), which is a property of Get My Profile. This will be required later, when email messages are sent to the manager.</p>



<p>Once the user and manager are defined, sending messages to teams, email and Automatic Reply are executed in parallel, so errors in one channel don&#8217;t impact the execution of the other channels, minimizing the chance of people not receiving my communication.</p>



<h3>Sending Messages to Teams</h3>



<figure class="wp-block-image is-resized"><img loading="lazy" src="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/teams-flow-1024x413.png" alt class="wp-image-2855" width="768" height="310" srcset="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/teams-flow-1024x413.png 1024w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/teams-flow-300x121.png 300w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/teams-flow-768x310.png 768w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/teams-flow-1200x484.png 1200w, http://localhost:2368http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/teams-flow.png 1680w, http://localhost:2368http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/teams-flow.png 2520w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 984px) 61vw, (max-width: 1362px) 45vw, 600px"><figcaption>Message to teams flow</figcaption></figure>



<p>The flow to send message to teams is based on a switch statement, which setup a variable &#8211; <strong>teamsmessagedetails</strong> &#8211; with the message to publish. I decided to make the WFH option &#8211; which I use the most &#8211; as the default option, so I end up initializing the variable with that value &#8211; for Flow it wouldn&#8217;t make any difference, but in Logic Apps that would make one less action execution, since you have to initialize the variable anyway.</p>



<p>Each case defines the message I wanted to publish, using the information provided by the flow button. The message is assigned tot the teamsmessagedetail variable.</p>



<p>To publish the message I am using the <strong>Post Notification in Teams </strong>action, updating 04 of their 5 inputs:</p>



<figure class="wp-block-image is-resized"><img loading="lazy" src="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/teams-post-notification-1024x452.png" alt class="wp-image-2856" width="613" height="271" srcset="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/teams-post-notification-1024x452.png 1024w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/teams-post-notification-300x132.png 300w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/teams-post-notification-768x339.png 768w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/teams-post-notification.png 1051w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 984px) 61vw, (max-width: 1362px) 45vw, 600px"></figure>



<ol><li>Team &#8211; the team where the message will be posted. I am hard coding this to the Theta All channel, which is where we defined as the location to publish this type of notification.</li><li>Channel &#8211; The channel where the message will be posted &#8211; as the Teams, I am hard coding this to General channel, as per our internal policy.</li><li>Message &#8211; The message being posted &#8211; this value is filled with the  value stored in the teamsmessagedetails variable.</li><li>Subject &#8211; The &#8220;title&#8221; of the message &#8211; I&#8217;ve decided to use this optional value, with a concatenation of <strong>Notification Type</strong> &#8211; <strong>Notification Detail</strong> (e.g. WFH &#8211; Writing a Blog Post).</li></ol>



<p>You could have created message with rich formatting if you wanted, since  <strong>Post Notification in Teams</strong> action also accept HTML input. In this case, remember to change the <strong>Type</strong> parameter to HTML, instead of the default text.</p>



<h3>Sending Email to Manager</h3>



<figure class="wp-block-image is-resized"><img loading="lazy" src="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/email-flow-707x1024.png" alt class="wp-image-2862" width="597" height="865" srcset="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/email-flow-707x1024.png 707w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/email-flow-207x300.png 207w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/email-flow-768x1113.png 768w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/email-flow-1200x1739.png 1200w, http://localhost:2368http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/email-flow.png 1680w, http://localhost:2368http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/email-flow.png 2520w" sizes="(max-width: 597px) 85vw, 597px"></figure>



<p>The email to manager flow works just like the Teams flow &#8211; but I didn&#8217;t want to bother my manager with email, every time I was a bit late for work. So, like in the Teams flow, the variable <strong>emailmessagedetail</strong> was initialized with the WFH option, and a switch was created for SICK and OUT. In all cases, the email was sent using HTML (including CSS stylesheet for rich formatting).</p>



<p>To send the email to the my manager, I used the <strong>Send an Email</strong> action of the <strong>Office 365 Outlook </strong>connector.</p>



<figure class="wp-block-image"><img loading="lazy" width="787" height="645" src="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/send-email-to-manager-1.png" alt class="wp-image-2864" srcset="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/send-email-to-manager-1.png 787w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/send-email-to-manager-1-300x246.png 300w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/send-email-to-manager-1-768x629.png 768w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 984px) 61vw, (max-width: 1362px) 45vw, 600px"></figure>



<ol><li>To &#8211; this field was populated with the <strong>Mail</strong> property of <strong>Find My Manager</strong> action setup at the top of the flow.</li><li>Subject &#8211; subject was populated with a concatenation of the <strong>Notification Type</strong> and <strong>Notification Detail</strong>.</li><li>Body &#8211; the body of the message receives the <strong>emailmessagedetail</strong> variable</li><li>CC &#8211; the CC field is populated with the list of <strong>Additional Notification</strong> <strong>People</strong> from the flow button.</li></ol>



<h3>Setup Automatic Replies</h3>



<figure class="wp-block-image is-resized"><img loading="lazy" src="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/Automatic-Replies-flow-1024x590.png" alt class="wp-image-2866" width="617" height="356" srcset="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/Automatic-Replies-flow-1024x590.png 1024w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/Automatic-Replies-flow-300x173.png 300w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/Automatic-Replies-flow-768x443.png 768w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/Automatic-Replies-flow-1200x692.png 1200w, http://localhost:2368http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/Automatic-Replies-flow.png 1757w, http://localhost:2368http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/Automatic-Replies-flow.png 1680w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 984px) 61vw, (max-width: 1362px) 45vw, 600px"></figure>



<p>Automatic replies differs a little bit from the other two options, because first I needed to decide if I wanted to create one or not &#8211; that decision was based on a boolean input in the flow button &#8211; <strong>Create Out of Office</strong>. Since the input was optional, I&#8217;ve created a boolean variable &#8211; <strong>createoutofoffice</strong> &#8211; and initialized it using the following function: <strong>coalesce(triggerBody()?[&#8216;boolean&#8217;],false) </strong> &#8211; where &#8216;boolean&#8217; is the name of the flow button input. This guarantee that if the value was not selected, the variable was set to false.</p>



<p>If the variable evaluates to true, the flow generates an out of office using the same pattern as the other two branches:</p>



<figure class="wp-block-image is-resized"><img loading="lazy" src="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/Out-of-Office-Flow-1024x382.png" alt class="wp-image-2867" width="612" height="229" srcset="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/Out-of-Office-Flow-1024x382.png 1024w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/Out-of-Office-Flow-300x112.png 300w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/Out-of-Office-Flow-768x287.png 768w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/Out-of-Office-Flow-1200x448.png 1200w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/Out-of-Office-Flow.png 1726w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 984px) 61vw, (max-width: 1362px) 45vw, 600px"></figure>



<p>As per email to manager this flow initializes the variable <strong>oofemailmessagedetail </strong>with the WFH message, and setup either the SICK or OUT messages within a switch. Finally the flow uses the <strong>Set up Automatic Replies </strong>action from <strong>Office365 Outlook</strong> connector, with the following items:</p>



<figure class="wp-block-image is-resized"><img loading="lazy" src="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/Setup-Out-of-Office-1024x463.png" alt class="wp-image-2868" width="610" height="276" srcset="http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/Setup-Out-of-Office-1024x463.png 1024w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/Setup-Out-of-Office-300x136.png 300w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/Setup-Out-of-Office-768x347.png 768w, http://localhost:2368/notetoselfblog/content/images/wordpress/2019/07/Setup-Out-of-Office.png 1053w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 984px) 61vw, (max-width: 1362px) 45vw, 600px"></figure>



<ol><li>Status &#8211; Set the status to scheduled</li><li>External Audience &#8211; Set to All (both internal and external)</li><li>Start Time &#8211;  For start time, I&#8217;ve used the <strong>utcNow()</strong>.</li><li>End Time &#8211; <strong> </strong>I&#8217;ve used the <strong>Return Date</strong> for End Time, which will turn off the Out of Office automatically at the date I&#8217;ve defined when trigger the flow.</li><li>Internal Reply Message &#8211; For the internal message I&#8217;ve used the <strong>oofemailmessagedetail</strong> variable.</li><li>External Reply Message &#8211; Since I didn&#8217;t want different messages for internal and external messages, I&#8217;ve also used the <strong>oofemailmessagedetail</strong> variable as the external message.</li></ol>



<h2>Summary</h2>



<p>Voilá! With this flow, I can setup my whereabouts in Teams, send an email to my manager and other people that might need to know my whereabouts on any particular day, and setup my automatic reply all in one goal. The Flow button is available from  the Microsoft Flow app for both Android and iPhone, so I have it handy anytime I want. I&#8217;ve already used it many times since I&#8217;ve setup the Flow, including during times where I had to be on a client site for a whole day and because of the morning commute I couldn&#8217;t have all of that communication setup for me. With a minute or so while waiting in the lobby of the client, everything was setup, including the automatic replies, so people would know that I would be late replying to their emails.</p>



<p>This is an example of personal productivity tool that can be achieved with Microsoft Flow. For sure, Microsoft Flow can do much more than just personal productivity, but for me this is an area where it is unbeatable, because there is no other tool that is as easily accessible and at same time as powerful in this space. </p>



<p>As a maker, you can create processes that are as simple as notify you when something important happens, to processes as complex as the one I&#8217;ve showed here that requires rich user input and orchestrate actions among multiple systems.</p>
<!--kg-card-end: html-->
        </section>

    </article>


</main>


        <section class="gh-container is-grid gh-outer">
            <div class="gh-container-inner gh-inner">
                <h2 class="gh-container-title">Read more</h2>
                <div class="gh-feed">
                        <article class="gh-card post">
    <a class="gh-card-link" href="/notetoselfblog/and-all-of-a-sudden-its-2022/">
            <figure class="gh-card-image">
                <img
                    srcset="/notetoselfblog/content/images/size/w160/format/webp/wordpress/2022/01/soar.png 160w,
                            /notetoselfblog/content/images/size/w320/format/webp/wordpress/2022/01/soar.png 320w,
                            /notetoselfblog/content/images/size/w600/format/webp/wordpress/2022/01/soar.png 600w,
                            /notetoselfblog/content/images/size/w960/format/webp/wordpress/2022/01/soar.png 960w,
                            /notetoselfblog/content/images/size/w1200/format/webp/wordpress/2022/01/soar.png 1200w,
                            /notetoselfblog/content/images/size/w2000/format/webp/wordpress/2022/01/soar.png 2000w"
                    sizes="320px"
                    src="/notetoselfblog/content/images/size/w600/wordpress/2022/01/soar.png"
                    alt="And all of a sudden, its 2022!"
                    loading="lazy"
                >
            </figure>
        <div class="gh-card-wrapper">
            <h3 class="gh-card-title is-title">And all of a sudden, its 2022!</h3>
                <p class="gh-card-excerpt is-body">And with that, another year goes by. Another year where communities had to revamp themselves and learn how to thrive in a online world. Here in NZ, after what started to look like we were pretty much bat to normal life, the reality of living during a pandemic stroked back,</p>
            <footer class="gh-card-meta"><!--
             -->
                    <span class="gh-card-author">By wsilveiranz</span>
                    <time class="gh-card-date" datetime="2022-01-09">Jan 9, 2022</time>
                <!--
         --></footer>
        </div>
    </a>
</article>                        <article class="gh-card post">
    <a class="gh-card-link" href="/notetoselfblog/calling-api-management-from-azure-function-using-managed-identities/">
            <figure class="gh-card-image">
                <img
                    srcset="/notetoselfblog/content/images/size/w160/format/webp/wordpress/2017/09/field-notes-wide-e1515541406829.jpg 160w,
                            /notetoselfblog/content/images/size/w320/format/webp/wordpress/2017/09/field-notes-wide-e1515541406829.jpg 320w,
                            /notetoselfblog/content/images/size/w600/format/webp/wordpress/2017/09/field-notes-wide-e1515541406829.jpg 600w,
                            /notetoselfblog/content/images/size/w960/format/webp/wordpress/2017/09/field-notes-wide-e1515541406829.jpg 960w,
                            /notetoselfblog/content/images/size/w1200/format/webp/wordpress/2017/09/field-notes-wide-e1515541406829.jpg 1200w,
                            /notetoselfblog/content/images/size/w2000/format/webp/wordpress/2017/09/field-notes-wide-e1515541406829.jpg 2000w"
                    sizes="320px"
                    src="/notetoselfblog/content/images/size/w600/wordpress/2017/09/field-notes-wide-e1515541406829.jpg"
                    alt="Calling API Management from Azure Function using Managed Identities"
                    loading="lazy"
                >
            </figure>
        <div class="gh-card-wrapper">
            <h3 class="gh-card-title is-title">Calling API Management from Azure Function using Managed Identities</h3>
                <p class="gh-card-excerpt is-body">One of the solutions I am consulting on today is securing a number of APIs with OAuth with client credential flow, using Azure Active Directory as the identity provider. Those APIs are exposed via Azure API Management, which makes the validation of the access tokens provided as simple as injecting</p>
            <footer class="gh-card-meta"><!--
             -->
                    <span class="gh-card-author">By wsilveiranz</span>
                    <time class="gh-card-date" datetime="2021-04-05">Apr 5, 2021</time>
                <!--
         --></footer>
        </div>
    </a>
</article>                        <article class="gh-card post">
    <a class="gh-card-link" href="/notetoselfblog/countdown-to-global-integration-bootcamp-2021/">
            <figure class="gh-card-image">
                <img
                    srcset="/notetoselfblog/content/images/size/w160/format/webp/wordpress/2021/02/GIB-2021-background.jpeg 160w,
                            /notetoselfblog/content/images/size/w320/format/webp/wordpress/2021/02/GIB-2021-background.jpeg 320w,
                            /notetoselfblog/content/images/size/w600/format/webp/wordpress/2021/02/GIB-2021-background.jpeg 600w,
                            /notetoselfblog/content/images/size/w960/format/webp/wordpress/2021/02/GIB-2021-background.jpeg 960w,
                            /notetoselfblog/content/images/size/w1200/format/webp/wordpress/2021/02/GIB-2021-background.jpeg 1200w,
                            /notetoselfblog/content/images/size/w2000/format/webp/wordpress/2021/02/GIB-2021-background.jpeg 2000w"
                    sizes="320px"
                    src="/notetoselfblog/content/images/size/w600/wordpress/2021/02/GIB-2021-background.jpeg"
                    alt="Countdown to Global Integration Bootcamp 2021"
                    loading="lazy"
                >
            </figure>
        <div class="gh-card-wrapper">
            <h3 class="gh-card-title is-title">Countdown to Global Integration Bootcamp 2021</h3>
                <p class="gh-card-excerpt is-body">Last January, I wrote about this year edition of Global Integration Bootcamp. As you might remember, this year we locked it on 26-27 February (UTC Time) running two different event streams starting at times that can be suitable for the three main time zone areas- APAC, EMEA and Americas.






Lineup</p>
            <footer class="gh-card-meta"><!--
             -->
                    <span class="gh-card-author">By wsilveiranz</span>
                    <time class="gh-card-date" datetime="2021-02-19">Feb 19, 2021</time>
                <!--
         --></footer>
        </div>
    </a>
</article>                        <article class="gh-card post">
    <a class="gh-card-link" href="/notetoselfblog/global-integration-bootcamp-2021-goes-virtual/">
            <figure class="gh-card-image">
                <img
                    srcset="/notetoselfblog/content/images/size/w160/format/webp/wordpress/2020/01/friends_banner.jpg 160w,
                            /notetoselfblog/content/images/size/w320/format/webp/wordpress/2020/01/friends_banner.jpg 320w,
                            /notetoselfblog/content/images/size/w600/format/webp/wordpress/2020/01/friends_banner.jpg 600w,
                            /notetoselfblog/content/images/size/w960/format/webp/wordpress/2020/01/friends_banner.jpg 960w,
                            /notetoselfblog/content/images/size/w1200/format/webp/wordpress/2020/01/friends_banner.jpg 1200w,
                            /notetoselfblog/content/images/size/w2000/format/webp/wordpress/2020/01/friends_banner.jpg 2000w"
                    sizes="320px"
                    src="/notetoselfblog/content/images/size/w600/wordpress/2020/01/friends_banner.jpg"
                    alt="Global Integration Bootcamp 2021 goes Virtual!!!"
                    loading="lazy"
                >
            </figure>
        <div class="gh-card-wrapper">
            <h3 class="gh-card-title is-title">Global Integration Bootcamp 2021 goes Virtual!!!</h3>
                <p class="gh-card-excerpt is-body">Hey there! Happy New Year!!!





Many of you were asking about if we would be doing another Global Integration Bootcamp this year. I know that there is been a while since we provided any news about it, but the team was trying to come up with a formula that would</p>
            <footer class="gh-card-meta"><!--
             -->
                    <span class="gh-card-author">By wsilveiranz</span>
                    <time class="gh-card-date" datetime="2021-01-12">Jan 12, 2021</time>
                <!--
         --></footer>
        </div>
    </a>
</article>                </div>
            </div>
        </section>

    
    <footer class="gh-footer gh-outer">
    <div class="gh-footer-inner gh-inner">

        <div class="gh-footer-bar">
            <span class="gh-footer-logo is-title">
                    Note to Self - Ghost Edition
            </span>
            <nav class="gh-footer-menu">
                <ul class="nav">
    <li class="nav-sign-up"><a href="#/portal/">Sign up</a></li>
</ul>

            </nav>
            <div class="gh-footer-copyright">
                Powered by <a href="https://ghost.org/" target="_blank" rel="noopener">Ghost</a>
            </div>
        </div>
        
                <section class="gh-footer-signup">
                    <h2 class="gh-footer-signup-header is-title">
                        Note to Self - Ghost Edition
                    </h2>
                    <p class="gh-footer-signup-subhead is-body">
                        Thoughts, stories and ideas.
                    </p>
                    <form class="gh-form" data-members-form>
    <input class="gh-form-input" type="email" placeholder="jamie@example.com" required data-members-email>
    <button class="gh-button" type="submit">
        <span><span>Subscribe</span> <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" viewBox="0 0 256 256"><path d="M224.49,136.49l-72,72a12,12,0,0,1-17-17L187,140H40a12,12,0,0,1,0-24H187L135.51,64.48a12,12,0,0,1,17-17l72,72A12,12,0,0,1,224.49,136.49Z"></path></svg></span>
        <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24">
    <g stroke-linecap="round" stroke-width="2" fill="currentColor" stroke="none" stroke-linejoin="round" class="nc-icon-wrapper">
        <g class="nc-loop-dots-4-24-icon-o">
            <circle cx="4" cy="12" r="3"></circle>
            <circle cx="12" cy="12" r="3"></circle>
            <circle cx="20" cy="12" r="3"></circle>
        </g>
        <style data-cap="butt">
            .nc-loop-dots-4-24-icon-o{--animation-duration:0.8s}
            .nc-loop-dots-4-24-icon-o *{opacity:.4;transform:scale(.75);animation:nc-loop-dots-4-anim var(--animation-duration) infinite}
            .nc-loop-dots-4-24-icon-o :nth-child(1){transform-origin:4px 12px;animation-delay:-.3s;animation-delay:calc(var(--animation-duration)/-2.666)}
            .nc-loop-dots-4-24-icon-o :nth-child(2){transform-origin:12px 12px;animation-delay:-.15s;animation-delay:calc(var(--animation-duration)/-5.333)}
            .nc-loop-dots-4-24-icon-o :nth-child(3){transform-origin:20px 12px}
            @keyframes nc-loop-dots-4-anim{0%,100%{opacity:.4;transform:scale(.75)}50%{opacity:1;transform:scale(1)}}
        </style>
    </g>
</svg>        <svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">
    <path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
    <style>
        .checkmark {
            width: 40px;
            height: 40px;
            display: block;
            stroke-width: 2.5;
            stroke: currentColor;
            stroke-miterlimit: 10;
        }

        .checkmark__check {
            transform-origin: 50% 50%;
            stroke-dasharray: 48;
            stroke-dashoffset: 48;
            animation: stroke .3s cubic-bezier(0.650, 0.000, 0.450, 1.000) forwards;
        }

        @keyframes stroke {
            100% { stroke-dashoffset: 0; }
        }
    </style>
</svg>    </button>
</form>                </section>

    </div>
</footer>    
</div>

    <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="pswp__bg"></div>

    <div class="pswp__scroll-wrap">
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>
<script src="/notetoselfblog/assets/built/source.js?v=c95e7abf59"></script>



</body>
</html>
